---
title: CosmodbSql
sidebar_position: 3
tags: [Azure, リソース, Cosmosdb, CosmodbSql]
---

<hr />
<br />

## リソースアイコン

<img
    src={
        "https://cloudstudioblob.blob.core.windows.net/cloudstudio/azureImg/cosmosdb-cosmosdb_sql.png"
    }
/>

## リソース概要

Cosmos DB SQL(Structured Query Language)は、Microsoft が提供する世界的に分散されたマルチモデルデータベースサービスである Azure Cosmos DB で使用されるクエリ言語です。
Cosmos DB SQL を使用すると、Cosmos DB コンテナの JSON 文書に対して SQL クエリを実行することができます。
おなじみの SQL 関数と式を使用して CRUD(作成、読み取り、アップデート、および削除)作業を行い、データをフィルタリングおよびソートし、データを集計することができます。
また、Cosmos DB SQL は、クエリー動作をカスタマイズし、データに対して複雑な作業を実行できる保存プロシージャ、トリガー、およびユーザ定義関数などの複数の高度な機能をサポートします。

### 上位リソース

-   [**Resource Group**](https://docs.cstudio.app/docs/resource/azure/Base/ResourceGroup)

## リソース設定値

-   `capabilities_list` : 使用する Cosmos DB の API リスト - `EnableServerless`, `EnableAggregationPipeline`

-   `enable_multiple_write_locations` : 世界中のデータベースとコンテナに対してプロビジョニングされたスループットを活用するためのマルチゾーン書き込みを活性化 - `true`, `false`

-   `public_network_access_enabled` : パブリック IP アドレスまたはサービス エンドポイントを介して公開的にアカウントへの接続を活性化 - `true`, `false`

-   `enable_automatic_failover` : 自動フェイルオーバーを活性化 - `true`, `false`

-   `virtual_network_filter_enabled` : 仮想ネットワーク上の特定 Subnet のみがアカウントにアクセスできるようにフィルタを活性化 - `true`, `false`

-   `network_acl_bypass_for_azure_services` : Azure サービスの ACL bypass を活性化 - `true`, `false`

-   `geo_location`

    -   `failover_priority` : リージョンのフェイルオーバー処理優先順位 - `0`~ `0`
    -   `zone_redundant` : エラーに備えて自動的に zone 複製を許容 - `true`~ `false`

-   `consistency_policy`

    -   `consistency_level` : データベースの可用性と性能設定のための Cassandra DB の一貫性レベル - `Eventual`, `Session`, `Strong`, `ConsistentPrefix`, `BoundedStaleness`
    -   `max_interval_in_seconds` : 一貫性レベルが Bounded Staleness の場合、許容される Staleness 時間(秒) - `5`~ `86400`
    -   `max_staleness_prefix` : 一貫性レベルが Bounded Staleness の場合、許容される最大 Stale Request 数 - `10`~`2147483647`

-   `backup`

    -   `type` : バックアップ ポリシー タイプ - `Continuous`, `Periodic`
    -   `interval_in_minutes` : バックアップを実行する毎分の頻度、60 ~ 1440 の範囲 - `60`~ `1440`
    -   `retention_in_hours` : バックアップを保存する期間(時間)、8~720 の範囲 - '8'~'720'

-   `sql_database`

    -   `throughput` : Cosmos DB SQL データベースの処理量 - `400`~ `1000000`
    -   `enable_autoscale` : Cassandra キースペースに autoscaling を適用するかどうか - `true`, `false`

-   `sql_container`

    -   `partition_key_version` : パーティションキーのバージョン 1 と 2 の中から指定 - `1`, `2`
    -   `partition_key_path` : SQL コンテナで使用する partition key を定義
    -   `throughput` : MongoDB Collection のスループット - `400`~ `100000`
    -   `indexing_mode` : インデックスタイプの設定 - `consistent`, `none`
    -   `included_path` : インデックスに含めるパスのリスト
    -   `excluded_path` : インデックスから除外されたパスのリスト
    -   `unique_key_path` : ユニークキーに使用するパスのリスト
    -   `enable_autoscale` : Cassandra キースペースに autoscaling を適用するかどうか - `true`, `false`
    -   `included_sql_database_name` : SQL コンテナが生成される SQL データベース名

-   `tag` : リソースをカテゴリに分類するためのタグ - 最大 512 文字, `key`:`value`

---

## 参考資料

-   [Azure Cosmosdb(Microsoft)](https://learn.microsoft.com/ko-kr/azure/cosmos-db/introduction)
-   [Azure Cosmosdb 価格](https://azure.microsoft.com/en-us/pricing/details/cosmos-db/autoscale-provisioned/)
-   [Azure Cosmosdb(Terraform)](https://registry.terraform.io/providers/hashicorp/azurerm/latest/docs/resources/cosmosdb_account)
